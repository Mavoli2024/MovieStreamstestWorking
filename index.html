<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Madifa Stream - Authentic Mzansi Stories</title>
    <!-- Performance Optimizations -->
    <meta name="description" content="Experience authentic South African storytelling with exclusive films and series. Premium Mzansi content streaming platform.">
    <meta name="keywords" content="South African movies, Mzansi films, African cinema, streaming platform">
    <link rel="preconnect" href="https://cdn.jsdelivr.net">
    <link rel="preconnect" href="https://vz-685277f9-aa1.b-cdn.net">
    <link rel="dns-prefetch" href="//cdn.jsdelivr.net">
    <link rel="dns-prefetch" href="//vz-685277f9-aa1.b-cdn.net">
    <!-- Critical CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/feather-icons/dist/feather.min.css" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container-fluid">
        <!-- Header -->
        <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
            <div class="container-fluid">
                <a class="navbar-brand fw-bold" href="#">
                    <i data-feather="film" class="me-2"></i>
                    Madifa
                </a>
                <div class="navbar-nav ms-auto">
                    <button id="debugToggle" class="btn btn-outline-light btn-sm me-2">
                        <i data-feather="tool" class="me-1"></i>
                        Debug
                    </button>
                    <a href="#" class="btn btn-primary btn-sm" id="signInBtn">
                        Sign In
                    </a>
                </div>
            </div>
        </nav>

        <!-- Hero Section -->
        <section class="hero-section bg-gradient text-white py-5 mb-4">
            <div class="container-fluid">
                <div class="row align-items-center">
                    <div class="col-lg-6">
                        <h1 class="display-4 fw-bold mb-3">Authentic Mzansi Stories</h1>
                        <p class="lead mb-4">Experience powerful South African storytelling with exclusive films and series you won't find anywhere else.</p>
                        <div class="d-flex gap-3">
                            <button class="btn btn-primary btn-lg">Watch Free Trailers</button>
                            <a href="#" class="btn btn-outline-light btn-lg" id="heroSignInBtn">Sign In & Start Watching</a>
                        </div>
                    </div>
                    <div class="col-lg-6">
                        <div id="heroVideoContainer" class="video-preview">
                            <!-- Hero video will be inserted here -->
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Debug Panel -->
        <div id="debugPanel" class="row mb-4" style="display: none;">
            <div class="col">
                <div class="card border-warning">
                    <div class="card-header bg-warning text-dark">
                        <h5 class="mb-0">
                            <i data-feather="tool" class="me-2"></i>
                            Debug Information
                        </h5>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-6">
                                <h6>CDN Configuration</h6>
                                <div id="cdnStatus" class="mb-3">
                                    <div class="status-item">
                                        <strong>Base URL:</strong> <span id="baseUrlStatus">-</span>
                                    </div>
                                    <div class="status-item">
                                        <strong>Authentication:</strong> <span id="authStatus">-</span>
                                    </div>
                                    <div class="status-item">
                                        <strong>CORS:</strong> <span id="corsStatus">-</span>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <h6>Player Status</h6>
                                <div id="playerStatus" class="mb-3">
                                    <div class="status-item">
                                        <strong>Current Source:</strong> <span id="currentSource">-</span>
                                    </div>
                                    <div class="status-item">
                                        <strong>Video State:</strong> <span id="videoState">-</span>
                                    </div>
                                    <div class="status-item">
                                        <strong>Network State:</strong> <span id="networkState">-</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col">
                                <h6>Console Logs</h6>
                                <div id="debugLogs" class="debug-logs">
                                    <!-- Debug logs will appear here -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Video Player Section -->
        <section class="mb-5">
            <div class="row">
                <div class="col-lg-8">
                    <div class="video-player-section">
                        <div id="videoContainer" class="video-container">
                            <video 
                                id="moviePlayer" 
                                class="video-player"
                                controls
                                preload="metadata"
                                crossorigin="anonymous"
                                playsinline
                                poster=""
                            >
                                <p>Your browser doesn't support HTML5 video.</p>
                            </video>
                            
                            <!-- Loading Overlay -->
                            <div id="loadingOverlay" class="loading-overlay">
                                <div class="spinner-border text-primary" role="status">
                                    <span class="visually-hidden">Loading...</span>
                                </div>
                                <p class="mt-2">Loading video...</p>
                            </div>

                            <!-- Error Overlay -->
                            <div id="errorOverlay" class="error-overlay" style="display: none;">
                                <div class="error-content">
                                    <i data-feather="alert-triangle" class="error-icon"></i>
                                    <h4>Video Playback Error</h4>
                                    <p id="errorMessage">An error occurred while trying to play the video.</p>
                                    <div id="errorDetails" class="error-details mt-3"></div>
                                    <button id="retryButton" class="btn btn-primary mt-3">
                                        <i data-feather="refresh-cw" class="me-1"></i>
                                        Retry
                                    </button>
                                </div>
                            </div>
                        </div>

                        <!-- Video Info -->
                        <div id="videoInfo" class="video-info mt-3" style="display: none;">
                            <h3 id="videoTitle" class="fw-bold">Movie Title</h3>
                            <p id="videoDescription" class="text-muted">Movie description will appear here.</p>
                        </div>
                    </div>
                </div>
                <div class="col-lg-4">
                    <!-- Video Controls Sidebar -->
                    <div class="controls-sidebar">
                        <div class="card">
                            <div class="card-header">
                                <h6 class="mb-0">Player Controls</h6>
                            </div>
                            <div class="card-body">
                                <div class="mb-3">
                                    <label class="form-label">Volume</label>
                                    <input type="range" class="form-range" id="volumeSlider" min="0" max="100" value="100">
                                </div>
                                <div class="mb-3">
                                    <label class="form-label">Playback Speed</label>
                                    <select class="form-select" id="speedSelect">
                                        <option value="0.5">0.5x</option>
                                        <option value="1" selected>1x</option>
                                        <option value="1.25">1.25x</option>
                                        <option value="1.5">1.5x</option>
                                        <option value="2">2x</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Trailers Section -->
        <section class="trailers-section mb-5">
            <div class="container-fluid">
                <div class="row">
                    <div class="col-12">
                        <h2 class="section-title mb-4">Get a Taste of Our Stories</h2>
                        <p class="text-muted mb-4">Watch these trailers and see what awaits you</p>
                    </div>
                </div>
                <div class="row">
                    <div class="col-12">
                        <div class="movies-grid">
                            <!-- Movie Grid -->
                            <div id="moviesList" class="row g-4">
                                <!-- Madifa Original Movies -->
                                <div class="col-md-6 col-lg-4">
                                    <div class="movie-card" data-filename="https://vz-685277f9-aa1.b-cdn.net/movies/ubuntu-short.mp4">
                                        <div class="movie-poster">
                                            <div class="placeholder-poster">
                                                <i data-feather="film" class="poster-icon"></i>
                                            </div>
                                            <div class="play-overlay">
                                                <i data-feather="play-circle" class="play-icon"></i>
                                            </div>
                                            <div class="movie-badge madifa-badge">Madifa Original</div>
                                        </div>
                                        <div class="movie-info">
                                            <h6>Ubuntu: Stories of Connection</h6>
                                            <small class="text-muted">Madifa Exclusive - 45 minutes</small>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="col-md-6 col-lg-4">
                                    <div class="movie-card" data-filename="https://vz-685277f9-aa1.b-cdn.net/movies/township-tales.mp4">
                                        <div class="movie-poster">
                                            <div class="placeholder-poster">
                                                <i data-feather="video" class="poster-icon"></i>
                                            </div>
                                            <div class="play-overlay">
                                                <i data-feather="play-circle" class="play-icon"></i>
                                            </div>
                                            <div class="movie-badge madifa-badge">Community Stories</div>
                                        </div>
                                        <div class="movie-info">
                                            <h6>Township Tales</h6>
                                            <small class="text-muted">Community Stories - 32 minutes</small>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="col-md-6 col-lg-4">
                                    <div class="movie-card" data-filename="https://vz-685277f9-aa1.b-cdn.net/movies/mzansi-dreams.mp4">
                                        <div class="movie-poster">
                                            <div class="placeholder-poster">
                                                <i data-feather="monitor" class="poster-icon"></i>
                                            </div>
                                            <div class="play-overlay">
                                                <i data-feather="play-circle" class="play-icon"></i>
                                            </div>
                                            <div class="movie-badge madifa-badge">Youth Aspirations</div>
                                        </div>
                                        <div class="movie-info">
                                            <h6>Mzansi Dreams</h6>
                                            <small class="text-muted">Youth Aspirations - 28 minutes</small>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="col-md-6 col-lg-4">
                                    <div class="movie-card" data-filename="https://vz-685277f9-aa1.b-cdn.net/movies/heritage-journey.mp4">
                                        <div class="movie-poster">
                                            <div class="placeholder-poster">
                                                <i data-feather="video" class="poster-icon"></i>
                                            </div>
                                            <div class="play-overlay">
                                                <i data-feather="play-circle" class="play-icon"></i>
                                            </div>
                                            <div class="movie-badge madifa-badge">Cultural Documentary</div>
                                        </div>
                                        <div class="movie-info">
                                            <h6>Heritage Journey</h6>
                                            <small class="text-muted">Cultural Documentary - 52 minutes</small>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="col-md-6 col-lg-4">
                                    <div class="movie-card" data-filename="https://vz-685277f9-aa1.b-cdn.net/movies/love-in-johannesburg.mp4">
                                        <div class="movie-poster">
                                            <div class="placeholder-poster">
                                                <i data-feather="heart" class="poster-icon"></i>
                                            </div>
                                            <div class="play-overlay">
                                                <i data-feather="play-circle" class="play-icon"></i>
                                            </div>
                                            <div class="movie-badge madifa-badge">Romance Drama</div>
                                        </div>
                                        <div class="movie-info">
                                            <h6>Love in Johannesburg</h6>
                                            <small class="text-muted">Romance Drama - 68 minutes</small>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="col-md-6 col-lg-4">
                                    <div class="movie-card" data-filename="https://vz-685277f9-aa1.b-cdn.net/movies/amandla-power.mp4">
                                        <div class="movie-poster">
                                            <div class="placeholder-poster">
                                                <i data-feather="zap" class="poster-icon"></i>
                                            </div>
                                            <div class="play-overlay">
                                                <i data-feather="play-circle" class="play-icon"></i>
                                            </div>
                                            <div class="movie-badge madifa-badge">Inspirational</div>
                                        </div>
                                        <div class="movie-info">
                                            <h6>Amandla: The Power Within</h6>
                                            <small class="text-muted">Inspirational - 41 minutes</small>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        
        <!-- Configuration Section (Collapsed by default) -->
        <section class="config-section mb-5">
            <div class="container-fluid">
                <div class="row">
                    <div class="col-12">
                        <div class="card">
                            <div class="card-header" data-bs-toggle="collapse" data-bs-target="#configCollapse" style="cursor: pointer;">
                                <h6 class="mb-0">
                                    <i data-feather="settings" class="me-2"></i>
                                    CDN Configuration
                                    <i data-feather="chevron-down" class="float-end"></i>
                                </h6>
                            </div>
                            <div id="configCollapse" class="collapse">
                                <div class="card-body">
                                    <div class="row">
                                        <div class="col-md-6">
                                            <div class="mb-3">
                                                <label for="cdnBaseUrl" class="form-label">Bunny CDN Base URL</label>
                                                <input 
                                                    type="text" 
                                                    id="cdnBaseUrl" 
                                                    class="form-control" 
                                                    placeholder="https://vz-685277f9-aa1.b-cdn.net"
                                                    value="https://vz-685277f9-aa1.b-cdn.net"
                                                >
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="mb-3">
                                                <label for="cdnToken" class="form-label">CDN Token (Optional)</label>
                                                <input 
                                                    type="password" 
                                                    id="cdnToken" 
                                                    class="form-control" 
                                                    placeholder="Authentication token"
                                                >
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-md-6">
                                            <button id="updateCdnConfig" class="btn btn-primary">
                                                Update CDN Configuration
                                            </button>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="mb-3">
                                                <label for="customVideoUrl" class="form-label">Custom Video URL</label>
                                                <div class="input-group">
                                                    <input 
                                                        type="text" 
                                                        id="customVideoUrl" 
                                                        class="form-control" 
                                                        placeholder="Video filename or full URL"
                                                    >
                                                    <button id="loadCustomVideo" class="btn btn-success">
                                                        <i data-feather="play" class="me-1"></i>
                                                        Load
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Status Bar -->
        <div class="status-bar bg-dark text-white py-2">
            <div class="container-fluid">
                <div class="row align-items-center">
                    <div class="col">
                        <small>
                            <span class="me-3">
                                <span id="cdnStatusIndicator" class="status-dot status-unknown"></span>
                                CDN: <span id="cdnStatusText">Ready</span>
                            </span>
                            <span>
                                <span id="playerStatusIndicator" class="status-dot status-unknown"></span>
                                Player: <span id="playerStatusText">Ready</span>
                            </span>
                        </small>
                    </div>
                    <div class="col-auto">
                        <small class="text-muted">Over 500+ hours of premium South African content</small>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Performance-optimized Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/feather-icons/dist/feather.min.js" defer></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js" defer></script>
    <!-- Application Scripts - Load in optimized order -->
    <script src="simple-auth.js" defer></script>
    <script src="bunny-cdn.js" defer></script>
    <script src="player.js" defer></script>
    <script src="debug-panel.js" defer></script>
    <script src="script.js" defer></script>
    
    <!-- Performance Monitoring -->
    <script>
        // Monitor page load performance
        window.addEventListener('load', function() {
            if (window.performance && window.performance.timing) {
                const loadTime = window.performance.timing.loadEventEnd - window.performance.timing.navigationStart;
                console.log('Page load time:', loadTime + 'ms');
                
                // Send performance metrics to server if available
                if (loadTime > 3000) {
                    console.warn('Slow page load detected:', loadTime + 'ms');
                }
            }
        });
    </script>
</body>
</html>
